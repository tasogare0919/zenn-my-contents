---
title: "docker-composeã§Terraformã‚’ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œã™ã‚‹"
emoji: "ğŸ³"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Terraform,Dokcer]
published: true
---
# æ¦‚è¦
Terraform ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã®ã§ã‚‚ã„ã„ã‘ã© docker-compose ã«ã—ã¦ãŠãã“ã¨ã‚‚ã‚„ã£ã¨ããŸã„ã¨æ€ã£ã¦ã‚„ã£ã¦ã¿ãŸå‚™å¿˜éŒ²ã§ã™.
ã‚°ã‚°ã£ãŸã‚‰ã„ã‚ã‚“ãªæƒ…å ±ãŒã‚ã‚Šã¾ã—ãŸãŒ[ã“ã¡ã‚‰](https://qiita.com/Tocyuki/items/0cb655e6357d9bf0c40f)ã‚’å‚è€ƒã«ã•ã›ã¦ã„ãŸã ãç’°å¢ƒä½œã‚Šã—ã¾ã—ãŸ.

Mac ã¯ã“ã‚“ãªç’°å¢ƒ

```sh
sw_vers 
ProductName:    Mac OS X
ProductVersion: 10.15.7
BuildVersion:   19H1217
```

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
ä¸‹ã¿ãŸã„ãªæ„Ÿã˜ã§ã™.

```sh
.
â”œâ”€â”€ README.md
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ terraform
â”‚   â”œâ”€â”€ aws.tf
â”‚   â”œâ”€â”€ variable.tf
â”‚   â””â”€â”€ vpc.tf
```

# docker-compose ã®ä¸­èº«
ä¸­èº«ã¯ã“ã‚“ãªæ„Ÿã˜

```yaml
version: '3'

services: 
    terraform:
        image: hashicorp/terraform:1.0.3
        container_name: terraform
        volumes:
            - ./terraform:/terraform
        env_file: .env
        working_dir: /terraform
```

`vpc.tf`ã«ã‚µãƒ–ãƒãƒƒãƒˆè¿½åŠ ã‚’ã—ã€è©¦ã—ã«`terraform plan`ã‚’å®Ÿè¡Œã—ã¦ã¿ãŸã‚‰ã„ã„æ„Ÿã˜ã«ãªã‚Šã¾ã—ãŸ.

```sh
docker-compose run --rm terraform plan
~ä¸­ç•¥~

Terraform used the selected providers to generate the
following execution plan. Resource actions are indicated
with the following symbols:
  + create

Terraform will perform the following actions:

  # aws_subnet.tf_private_subnet_1c will be created
  + resource "aws_subnet" "tf_private_subnet_1c" {
      + arn                             = (known after apply)
      + assign_ipv6_address_on_creation = false
      + availability_zone               = "ap-northeast-1c"
      + availability_zone_id            = (known after apply)
      + cidr_block                      = "10.10.4.0/24"
      + id                              = (known after apply)
      + ipv6_cidr_block_association_id  = (known after apply)
      + map_public_ip_on_launch         = false
      + owner_id                        = (known after apply)
      + tags                            = {
          + "Name"  = "tf-private-subnet-1c"
          + "Owner" = "tada"
        }
      + tags_all                        = {
          + "Name"  = "tf-private-subnet-1c"
          + "Owner" = "tada"
        }
      + vpc_id                          = "vpc-xxxx"
    }

Plan: 1 to add, 0 to change, 0 to destroy.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Note: You didn't use the -out option to save this plan, so
Terraform can't guarantee to take exactly these actions if
you run "terraform apply" now.
```